{
  "name": "worktrunk-default-branch",
  "description": "Test default branch detection tool",
  "dataset": {
    "name": "default-branch",
    "examples": [
      {
        "id": "get-default",
        "inputs": {
          "query": "Get the default branch name using worktrunk-default-branch tool"
        }
      },
      {
        "id": "use-default",
        "inputs": {
          "query": "Get the default branch and then switch to it using worktrunk-switch"
        }
      }
    ]
  },
  "variants": {
    "with-plugin": {
      "plugins": ["opencode-worktrunk"]
    }
  },
  "setup": {
    "template": "empty",
    "vcs": {
      "git": {
        "defaultBranch": "main",
        "commits": [
          {
            "message": "Initial commit",
            "files": {
              "README.md": "# Test Project"
            }
          }
        ]
      }
    }
  },
  "evaluators": [
    {
      "type": "code",
      "assertions": [
        {
          "type": "tool_called",
          "tool": "worktrunk-default-branch"
        },
        {
          "type": "environment_state",
          "check": "default_branch_matches",
          "branch": "main",
          "description": "Default branch is actually detected as 'main' in the environment"
        }
      ]
    },
    {
      "type": "llm-judge",
      "criteria": [
        "Default branch is actually detected correctly in the environment (verified, not just tool called)",
        "Tool works regardless of whether default is 'main' or 'master'",
        "Default branch information matches the actual git repository configuration",
        "Default branch information is useful for scripts and automation"
      ],
      "reference_free": true
    }
  ],
  "error_handling": {
    "on_error": "continue",
    "timeout_ms": 120000
  }
}
