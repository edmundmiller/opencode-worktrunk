{
  "name": "worktrunk-json-api",
  "description": "Test JSON API support for worktrunk-list tool",
  "dataset": {
    "name": "json-api",
    "examples": [
      {
        "id": "list-json",
        "inputs": {
          "query": "List all WorkTrunk worktrees in JSON format using worktrunk-list with --format=json"
        }
      },
      {
        "id": "parse-json",
        "inputs": {
          "query": "Use worktrunk-list with JSON output and parse the results to show only branch names"
        }
      }
    ]
  },
  "variants": {
    "with-plugin": {
      "plugins": ["opencode-worktrunk"]
    }
  },
  "setup": {
    "template": "empty",
    "vcs": {
      "git": {
        "defaultBranch": "main",
        "commits": [
          {
            "message": "Initial commit",
            "files": {
              "README.md": "# Test Project"
            }
          }
        ],
        "branches": ["feature/test", "bugfix/issue-1"]
      }
    }
  },
  "evaluators": [
    {
      "type": "code",
      "assertions": [
        {
          "type": "tool_called",
          "tool": "worktrunk-list",
          "args_contain": "json"
        },
        {
          "type": "environment_state",
          "check": "json_valid",
          "description": "JSON output is actually valid and parseable"
        },
        {
          "type": "environment_state",
          "check": "json_contains_fields",
          "fields": ["branch", "status"],
          "description": "JSON structure contains expected fields (branch, status, etc.)"
        }
      ]
    },
    {
      "type": "llm-judge",
      "criteria": [
        "JSON output is actually valid and parseable (verified, not just tool called)",
        "JSON structure contains expected fields and can be used programmatically",
        "JSON format provides structured data that is more useful than plain text",
        "JSON parsing works correctly in the evaluation environment"
      ],
      "reference_free": true
    }
  ],
  "error_handling": {
    "on_error": "continue",
    "timeout_ms": 120000
  }
}
